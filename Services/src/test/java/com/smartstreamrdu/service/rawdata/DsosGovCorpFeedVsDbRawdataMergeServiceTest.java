/*******************************************************************
 *
 * Copyright (c) 2009-2022 The SmartStream Reference Data Utility 
 * All rights reserved. 
 *
 * File:	DsosFeedVsDbRawdataMergeServiceTest.java
 * Author:	Dedhia
 * Date:	Mar 15, 2023
 *
 *******************************************************************/
package com.smartstreamrdu.service.rawdata;

import static org.junit.Assert.*;

import java.util.Set;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import com.smartstreamrdu.domain.Record;
import com.smartstreamrdu.persistence.mongodb.MongoConfig;
import com.smartstreamrdu.service.jsonconverter.JsonConverterUtil;

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(classes = { MongoConfig.class })
public class DsosGovCorpFeedVsDbRawdataMergeServiceTest {

	@Autowired
	@Qualifier("DsosGovCorpFeedVsDbRawdataMergeService")
	private FeedVsDbRawdataMergeService feedVsDbMergeService;
	
	private static final String ID_OBJ_XREF_HIST_TABLE_NAME = "id_obj_xref_hist";

	final static String DSOS_FEED_JSON = "{\"govcorp\":{\"asset2\":{\"prtl_redemp_fl\":null,\"callable_notation\":null,\"repo_elig_id\":null,\"cusip_change_cd\":null,\"toggle_note_fl\":\"n\",\"instr_name\":\"% FIX CORP DUE 2030\",\"asset_id\":\"0x0010559d9dcf0288\",\"cur_cpn_class_cd\":\"TBP\",\"straight_bond_fl\":\"n\",\"risk_country_cd\":null,\"sukuk_structure_fl\":null,\"prin_pay_redempt_cd\":null,\"fdic_insu_fl\":\"kushal\",\"post_iss_icma_fl\":null,\"latest_iss_px\":\"100.0\",\"write_down_trigger_cd\":null,\"crd_compliance_fl\":null,\"dfrd_int_cnvrsn_dt\":null,\"trade_settle_curr_cd\":null,\"facility_amt\":null,\"aaoifi_compliant_fl\":null,\"hybrid_fl\":\"n\",\"next_par_call_dt\":null,\"odd_first_cpn_cd\":\"R\",\"liquidation_preference_cd\":\"SRS\",\"write_up_fl\":null,\"odd_first_cpn\":null,\"announcement_dt\":\"2023-03-08 04:00:00.0\",\"flip_opt_dt\":\"2026-03-15 00:00:00.0\",\"transition_bond_fl\":\"n\",\"green_bond_fl\":\"n\",\"sharia_opinion_fl\":null,\"gen_pay_rank_cd\":\"SSE\",\"conver_cd\":null,\"seniority_cd\":\"SR\",\"us_baby_bond_fl\":null,\"puttable_notation\":\"7np3(1x)\",\"orig_cusip_type_cd\":null,\"tax_credit_fl\":\"n\",\"cfi\":null,\"realtime_bond_type\":\"S\",\"debt_recourse_cd\":\"Y\",\"dtc_elig_fl\":null,\"us_section_13f_fl\":\"n\",\"trading_flat_fl\":null,\"esg_icma_fl\":null,\"odd_last_cpn_fl\":\"n\",\"esg_label_cd\":null,\"retail_sec_fl\":\"n\",\"eu_taxonomy_fl\":null,\"fisn\":null,\"series\":null,\"tlac_elig_fl\":null,\"div_stopper_fl\":null,\"facility\":null,\"ftt_liable_fl\":\"n\",\"next_par_call_px\":null,\"reoffered_dt\":null,\"src_of_pmt_cd\":null,\"over_subscription\":null,\"bailin_fl\":null,\"cur_rate_cd\":null,\"flip_opt_cd\":\"IO\",\"cav_maturity_amt\":null,\"esg_compliance_cd\":null,\"ftt_report_fl\":\"n\",\"org_of_risk_id\":null,\"latest_iss_dt\":\"2023-03-14 00:00:00.0\",\"cur_amt_factor\":\"1.0\",\"security_cd\":\"OTH\",\"odd_first_cpn_fl\":\"n\",\"div_pusher_fl\":null,\"ucits_compliance_fl\":null,\"prerefunded_fl\":null,\"structured_fl\":\"n\",\"term_to_maturity_yrs\":\"7Y\",\"reoffered_fl\":null,\"isa_eligible_fl\":\"y\",\"repo_elig_fl\":\"n\",\"rrps_ric_permid\":null,\"org_of_risk_audit_cd\":null,\"tier_capital_cd\":null,\"cic_cd\":\"CN29\",\"survivor_opt_fl\":\"n\",\"odd_last_cpn_cd\":\"R\",\"local_iss_dt\":null,\"write_down_trigg_ratio\":null,\"cdc_asset_class_cd\":null,\"letter_of_credit_fl\":\"n\",\"structured_cd\":null,\"estimated_free_cnv_fl\":null,\"borrower_id\":null,\"cusip_change_dt\":null,\"finra_sub_prdct_type_cd\":null,\"solvability_ratio\":null,\"cleanup_call_fl\":\"n\",\"cntry_of_risk_cd\":null,\"cur_int_defer_fl\":\"n\",\"risk_classifications_cd\":null,\"trade_asset_type_cd\":null,\"make_whole_call_fl\":\"n\",\"write_down_fl\":null,\"issue_id\":null,\"esg_bond_fl\":\"n\",\"calc_disable_rsn\":null,\"qdi_elig_fl\":\"n\",\"write_down_type_cd\":null,\"super_sinker_fl\":null,\"asset_eff_dt\":\"2023-03-14 00:00:00.0\",\"realtime_building_block\":\"CORP\",\"pgm_iss_fl\":\"n\",\"addl_credit_fl\":null,\"mrel_elig_fl\":null,\"drd_elig_fl\":\"n\",\"cap_cont_fl\":\"n\"},\"rduSecurities\":[{\"security\":{\"mic_opol\":{\"sedol_eff_dt\":null,\"opol_fl\":null,\"asset_id\":null,\"sedol\":null,\"sedol_end_dt\":null,\"mic_cd\":null}}}],\"asset\":{\"current_cpn\":null,\"wpk_nm\":null,\"funged_fl\":\"n\",\"bankwatch_rating_dt\":null,\"latest_rating_src_cd\":null,\"asset_id\":\"0x0010559d9dcf0288\",\"asset_status_cd\":\"TBP\",\"ibs_control_nm\":null,\"project_name\":null,\"emerging_market_fl\":\"y\",\"last_reset_dt\":null,\"mandatory_tender_dt\":null,\"mdy_rating_cd\":null,\"unit_cd\":null,\"next_sink_dt\":null,\"strip_total\":null,\"capitalization_fl\":\"n\",\"next_put_dt\":\"2026-03-15 00:00:00.0\",\"dom_settle_val\":\"1\",\"pay_freq_cd\":\"1\",\"mdy_rating_dt\":null,\"cur_prin_leg_nm\":\"1\",\"debt_svc_cd\":null,\"put_terms_fl\":\"y\",\"tot_prog_amt\":null,\"mdy_st_rtng_dt\":null,\"dcs_type_cd\":\"B\",\"next_pay_dt\":\"2024-03-15 00:00:00.0\",\"asset_setup_dt\":\"2023-03-08 04:00:00.0\",\"cur_amt_outsd\":\"500000.0\",\"trace_cd\":\"N\",\"next_reset_dt\":null,\"strippable_fl\":\"n\",\"day_count_cd\":\"5\",\"ibca_rating_dt\":null,\"rtfi_us_elig_cd\":\"UNS\",\"tap_end_dt\":null,\"status_of_document\":\"2\",\"exdiv_val\":null,\"asset_duplicate_cd\":null,\"valoren_nm\":null,\"life_cap\":null,\"pay_in_part_fl\":\"n\",\"oid_fl\":null,\"prospectus_dt\":\"2023-03-14 00:00:00.0\",\"mdy_watch_cd\":null,\"credit_sensitive_fl\":\"n\",\"dp_rating_dt\":null,\"lead_undwrt_cd\":\"HUC\",\"sp_rating_cd\":null,\"clawback_type_cd\":null,\"min_denom\":\"100.0\",\"call_terms_fl\":\"n\",\"call_type_cd\":null,\"mdy_watch_dt\":null,\"sp_st_rtng_cd\":null,\"nsin_nm\":null,\"float_mult\":null,\"min_credit_rating_cd\":\"AA\",\"native_yld_type_cd\":\"CB\",\"asset_ticker\":\"SOGOV\",\"fitch_rating_cd\":null,\"asset_templt_cd\":\"CC\",\"bankwatch_rating_cd\":null,\"annuity_fl\":\"n\",\"cpn_type_cd\":\"TBPD\",\"refund_dt\":null,\"status_eff_dt\":\"2023-03-08 00:00:00.0\",\"convertible_fl\":\"n\",\"tap_issue_fl\":\"n\",\"asset_permid\":\"232804226926\",\"latest_rating_eff_dt\":null,\"cur_amt_outsd_chg_cd\":\"ISS\",\"prosp_on_file_fl\":\"y\",\"sovr_class_cd\":null,\"sp_watch_dt\":null,\"dom_settle_cal_cd\":\"BDY\",\"last_cpn_dt\":\"2029-03-15 00:00:00.0\",\"redemption_val\":\"100.0\",\"orig_iss_dt\":\"2023-03-14 00:00:00.0\",\"record_dt_val\":null,\"stick_suppl_fl\":\"n\",\"exdiv_cal_cd\":null,\"multistep_flt_fl\":\"n\",\"dp_rating_cd\":null,\"float_offset\":null,\"cur_prin_curr_cd\":\"CNY\",\"secondary_insu_fl\":null,\"issuer_id\":\"0x00102c4c47b8149b\",\"record_dt_cd\":null,\"common_code_nm\":null,\"next_sink_amt\":null,\"orig_amt_iss\":\"500000.0\",\"series\":null,\"fitch_ibca_rating_cd\":null,\"tax_call_fl\":\"n\",\"asset_cf_corr_dt\":null,\"descr_detail\":null,\"er_score\":\"4\",\"prosp_suppl_dt\":null,\"rrps_ric\":null,\"domin_rating_cd\":null,\"exch_listed_fl\":\"y\",\"ibca_rating_cd\":null,\"next_call_px\":null,\"primary_quote_id\":null,\"fitch_rating_dt\":null,\"cusip\":null,\"pik_inkind_pmt_dt\":null,\"tax_status_cd\":null,\"equity_clawback_fl\":\"n\",\"amt_iss_tot\":\"500000.0\",\"next_call_dt\":null,\"physical_form_cd\":\"BKE\",\"isin_nm\":null,\"mtn_shelf_id\":null,\"full_bridge_symbol\":\"cn*;SOGOV-TBP-0330\",\"pik_fl\":\"n\",\"ds_subtype_cd\":\"CFIN\",\"life_floor\":null,\"domin_rating_dt\":null,\"fitch_ibca_rating_dt\":null,\"pay_cal_cd\":\"CDM\",\"first_cpn_dt\":\"2024-03-15 00:00:00.0\",\"maturity_dt\":\"2030-03-15 00:00:00.0\",\"dual_cur_fl\":\"n\",\"first_reset_dt\":null,\"cur_int_leg_nm\":\"1\",\"next_put_px\":\"100.0\",\"distribution_src_cd\":\"RTRI\",\"perpetual_fl\":\"n\",\"cpn_class_cd\":\"TBP\",\"latest_rating_cd\":null,\"sp_st_rtng_dt\":null,\"bridge_symbol\":\"SOGOV-TBP-0330\",\"dbs_pid\":\"110000B058RM4\",\"int_idx_lnk_fl\":null,\"float_index\":null,\"debt_type_cd\":\"CNENTERP\",\"prosp_suppl_nm\":null,\"sec_class_cd\":null,\"descr\":\"SOGOV        03/15/30 PUT\",\"sp_watch_cd\":null,\"cntry_of_iss_cd\":\"CN\",\"sp_rating_dt\":null,\"eusd_tax_fl\":\"y\",\"currency_cd\":\"CNY\",\"withholding_tax\":null,\"orig_dated_dt\":\"2023-03-15 00:00:00.0\",\"exec_quote_fl\":\"n\",\"warrants_fl\":\"n\",\"sp_debt_class_cd\":null,\"private_place_fl\":\"n\",\"nsin_agn_cd\":\"ISN\",\"mtn_fl\":\"n\",\"denom_type_cd\":\"BKE\",\"euroclear_nm\":null,\"poison_put_fl\":\"n\",\"isin_src_cd\":null,\"trace_grade_cd\":null,\"asset_subtype_cd\":\"DMTC\",\"amt_iss_public\":null,\"asset_type_cd\":\"CORP\",\"defeased_fl\":\"n\",\"settle_bus_ctr_cd\":\"CN\",\"float_formula\":null,\"asset_last_chg_dt\":\"2023-03-08 09:42:00.0\",\"standard_yld_type_cd\":\"IS\",\"denom_incr\":\"100.0\",\"asset_info_src_cd\":\"RTR\",\"mdy_st_rtng_cd\":null,\"spec_put_fl\":\"n\",\"prin_idx_lnk_fl\":\"n\",\"guarantee_fl\":\"y\",\"pay_cal_val\":\"15\",\"fund_terms_fl\":\"y\",\"mdy_debt_class_cd\":null,\"pik_csh_pmt_dt\":null,\"bank_qualified_fl\":null,\"exp_maturity_dt\":null,\"secured_fl\":\"y\",\"for_settle_val\":null,\"next_mand_tender_dt\":null,\"fig_rule_cd\":\"C\",\"rtr_ticker\":\"SOGOVP\",\"rcs_class_cd\":\"BOND\",\"extend_terms_fl\":\"n\",\"preferred_ric\":null,\"ds_type_cd\":\"CORP\",\"inflation_protect_fl\":\"n\",\"cur_amt_out_dt\":\"2023-03-14 00:00:00.0\"},\"id_obj_xref_hist\":[{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"CN*;SOGOV-TBP-0330\",\"obj_oid\":\"0x0010559d9dcf0288\",\"id_type_cd\":\"BDG\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2023-03-08 00:00:00.0\",\"obj_type_cd\":\"GCBD\",\"id_value\":\"cn*;SOGOV-TBP-0330\",\"global_region_cd\":\"A\"},{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"110000B058RM4\",\"obj_oid\":\"0x0010559d9dcf0288\",\"id_type_cd\":\"DBS\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2023-03-08 00:00:00.0\",\"obj_type_cd\":\"GCBD\",\"id_value\":\"110000B058RM4\",\"global_region_cd\":\"A\"}]}}";
	final static String DSOS_FEED_JSON1 = "{\"govcorp\":{\"asset2\":{\"prtl_redemp_fl\":null,\"callable_notation\":null,\"repo_elig_id\":null,\"cusip_change_cd\":null,\"toggle_note_fl\":\"n\",\"instr_name\":\"% FIX CORP DUE 2030\",\"asset_id\":\"0x0010559d9dcf0288\",\"cur_cpn_class_cd\":\"TBP\",\"flip_opt_fl\":\"y\",\"straight_bond_fl\":\"n\",\"risk_country_cd\":null,\"sukuk_structure_fl\":null,\"prin_pay_redempt_cd\":null,\"fdic_insu_fl\":null,\"post_iss_icma_fl\":null,\"latest_iss_px\":\"100.0\",\"write_down_trigger_cd\":null,\"crd_compliance_fl\":null,\"dfrd_int_cnvrsn_dt\":null,\"trade_settle_curr_cd\":null,\"facility_amt\":null,\"aaoifi_compliant_fl\":null,\"hybrid_fl\":\"n\",\"next_par_call_dt\":null,\"odd_first_cpn_cd\":\"R\",\"liquidation_preference_cd\":\"SRS\",\"write_up_fl\":null,\"odd_first_cpn\":null,\"announcement_dt\":\"2023-03-08 04:00:00.0\",\"flip_opt_dt\":\"2026-03-15 00:00:00.0\",\"transition_bond_fl\":\"n\",\"green_bond_fl\":\"n\",\"sharia_opinion_fl\":null,\"gen_pay_rank_cd\":\"SSE\",\"conver_cd\":null,\"seniority_cd\":\"SR\",\"us_baby_bond_fl\":null,\"puttable_notation\":\"7np3(1x)\",\"orig_cusip_type_cd\":null,\"tax_credit_fl\":\"n\",\"cfi\":null,\"realtime_bond_type\":\"S\",\"debt_recourse_cd\":\"Y\",\"dtc_elig_fl\":null,\"us_section_13f_fl\":\"n\",\"trading_flat_fl\":null,\"esg_icma_fl\":null,\"odd_last_cpn_fl\":\"n\",\"esg_label_cd\":null,\"retail_sec_fl\":\"n\",\"eu_taxonomy_fl\":null,\"fisn\":null,\"series\":null,\"tlac_elig_fl\":null,\"div_stopper_fl\":null,\"facility\":null,\"ftt_liable_fl\":\"n\",\"next_par_call_px\":null,\"reoffered_dt\":null,\"src_of_pmt_cd\":null,\"over_subscription\":null,\"bailin_fl\":null,\"cur_rate_cd\":null,\"flip_opt_cd\":\"IO\",\"cav_maturity_amt\":null,\"esg_compliance_cd\":null,\"ftt_report_fl\":\"n\",\"org_of_risk_id\":null,\"latest_iss_dt\":\"2023-03-14 00:00:00.0\",\"cur_amt_factor\":\"1.0\",\"security_cd\":\"OTH\",\"odd_first_cpn_fl\":\"n\",\"div_pusher_fl\":null,\"ucits_compliance_fl\":null,\"prerefunded_fl\":null,\"structured_fl\":\"n\",\"term_to_maturity_yrs\":\"7Y\",\"reoffered_fl\":null,\"isa_eligible_fl\":\"y\",\"repo_elig_fl\":\"n\",\"rrps_ric_permid\":null,\"org_of_risk_audit_cd\":null,\"tier_capital_cd\":null,\"cic_cd\":\"CN29\",\"survivor_opt_fl\":\"n\",\"odd_last_cpn_cd\":\"R\",\"local_iss_dt\":null,\"write_down_trigg_ratio\":null,\"cdc_asset_class_cd\":null,\"letter_of_credit_fl\":\"n\",\"structured_cd\":null,\"estimated_free_cnv_fl\":null,\"borrower_id\":null,\"cusip_change_dt\":null,\"finra_sub_prdct_type_cd\":null,\"solvability_ratio\":null,\"cleanup_call_fl\":\"n\",\"cntry_of_risk_cd\":null,\"cur_int_defer_fl\":\"n\",\"risk_classifications_cd\":null,\"trade_asset_type_cd\":null,\"make_whole_call_fl\":\"n\",\"write_down_fl\":null,\"issue_id\":null,\"esg_bond_fl\":\"n\",\"calc_disable_rsn\":null,\"qdi_elig_fl\":\"n\",\"write_down_type_cd\":null,\"super_sinker_fl\":null,\"asset_eff_dt\":\"2023-03-14 00:00:00.0\",\"realtime_building_block\":\"CORP\",\"pgm_iss_fl\":\"n\",\"addl_credit_fl\":null,\"mrel_elig_fl\":null,\"drd_elig_fl\":\"n\",\"cap_cont_fl\":\"n\"},\"asset\":{\"current_cpn\":null,\"wpk_nm\":null,\"funged_fl\":\"n\",\"bankwatch_rating_dt\":null,\"latest_rating_src_cd\":null,\"asset_id\":\"0x0010559d9dcf0288\",\"asset_status_cd\":\"TBP\",\"ibs_control_nm\":null,\"project_name\":null,\"emerging_market_fl\":\"y\",\"last_reset_dt\":null,\"mandatory_tender_dt\":null,\"mdy_rating_cd\":null,\"unit_cd\":null,\"next_sink_dt\":null,\"strip_total\":null,\"capitalization_fl\":\"n\",\"next_put_dt\":\"2026-03-15 00:00:00.0\",\"dom_settle_val\":\"1\",\"pay_freq_cd\":\"1\",\"mdy_rating_dt\":null,\"cur_prin_leg_nm\":\"1\",\"debt_svc_cd\":null,\"put_terms_fl\":\"y\",\"tot_prog_amt\":null,\"mdy_st_rtng_dt\":null,\"dcs_type_cd\":\"B\",\"next_pay_dt\":\"2024-03-15 00:00:00.0\",\"asset_setup_dt\":\"2023-03-08 04:00:00.0\",\"cur_amt_outsd\":\"500000.0\",\"trace_cd\":\"N\",\"next_reset_dt\":null,\"strippable_fl\":\"n\",\"day_count_cd\":\"5\",\"ibca_rating_dt\":null,\"rtfi_us_elig_cd\":\"UNS\",\"tap_end_dt\":null,\"status_of_document\":\"2\",\"exdiv_val\":null,\"asset_duplicate_cd\":null,\"valoren_nm\":null,\"life_cap\":null,\"pay_in_part_fl\":\"n\",\"oid_fl\":null,\"prospectus_dt\":\"2023-03-14 00:00:00.0\",\"mdy_watch_cd\":null,\"credit_sensitive_fl\":\"n\",\"dp_rating_dt\":null,\"lead_undwrt_cd\":\"HUC\",\"sp_rating_cd\":null,\"clawback_type_cd\":null,\"min_denom\":\"100.0\",\"call_terms_fl\":\"n\",\"call_type_cd\":null,\"mdy_watch_dt\":null,\"sp_st_rtng_cd\":null,\"nsin_nm\":null,\"float_mult\":null,\"min_credit_rating_cd\":\"AA\",\"native_yld_type_cd\":\"CB\",\"asset_ticker\":\"SOGOV\",\"fitch_rating_cd\":null,\"asset_templt_cd\":\"CC\",\"bankwatch_rating_cd\":null,\"annuity_fl\":\"n\",\"cpn_type_cd\":\"TBPD\",\"refund_dt\":null,\"status_eff_dt\":\"2023-03-08 00:00:00.0\",\"convertible_fl\":\"n\",\"tap_issue_fl\":\"n\",\"asset_permid\":\"232804226926\",\"latest_rating_eff_dt\":null,\"cur_amt_outsd_chg_cd\":\"ISS\",\"prosp_on_file_fl\":\"y\",\"sovr_class_cd\":null,\"sp_watch_dt\":null,\"dom_settle_cal_cd\":\"BDY\",\"last_cpn_dt\":\"2029-03-15 00:00:00.0\",\"redemption_val\":\"100.0\",\"orig_iss_dt\":\"2023-03-14 00:00:00.0\",\"record_dt_val\":null,\"stick_suppl_fl\":\"n\",\"exdiv_cal_cd\":null,\"multistep_flt_fl\":\"n\",\"dp_rating_cd\":null,\"float_offset\":null,\"cur_prin_curr_cd\":\"CNY\",\"secondary_insu_fl\":null,\"issuer_id\":\"0x00102c4c47b8149b\",\"record_dt_cd\":null,\"common_code_nm\":null,\"next_sink_amt\":null,\"orig_amt_iss\":\"500000.0\",\"series\":null,\"fitch_ibca_rating_cd\":null,\"tax_call_fl\":\"n\",\"asset_cf_corr_dt\":null,\"descr_detail\":null,\"er_score\":\"4\",\"prosp_suppl_dt\":null,\"rrps_ric\":null,\"domin_rating_cd\":null,\"exch_listed_fl\":\"y\",\"ibca_rating_cd\":null,\"next_call_px\":null,\"primary_quote_id\":null,\"fitch_rating_dt\":null,\"cusip\":null,\"pik_inkind_pmt_dt\":null,\"tax_status_cd\":null,\"equity_clawback_fl\":\"n\",\"amt_iss_tot\":\"500000.0\",\"next_call_dt\":null,\"physical_form_cd\":\"BKE\",\"isin_nm\":null,\"mtn_shelf_id\":null,\"full_bridge_symbol\":\"cn*;SOGOV-TBP-0330\",\"pik_fl\":\"n\",\"ds_subtype_cd\":\"CFIN\",\"life_floor\":null,\"domin_rating_dt\":null,\"fitch_ibca_rating_dt\":null,\"pay_cal_cd\":\"CDM\",\"first_cpn_dt\":\"2024-03-15 00:00:00.0\",\"maturity_dt\":\"2030-03-15 00:00:00.0\",\"dual_cur_fl\":\"n\",\"first_reset_dt\":null,\"cur_int_leg_nm\":\"1\",\"next_put_px\":\"100.0\",\"distribution_src_cd\":\"RTRI\",\"perpetual_fl\":\"n\",\"cpn_class_cd\":\"TBP\",\"latest_rating_cd\":null,\"sp_st_rtng_dt\":null,\"bridge_symbol\":\"SOGOV-TBP-0330\",\"dbs_pid\":\"110000B058RM4\",\"int_idx_lnk_fl\":null,\"float_index\":null,\"debt_type_cd\":\"CNENTERP\",\"prosp_suppl_nm\":null,\"sec_class_cd\":null,\"descr\":\"SOGOV        03/15/30 PUT\",\"sp_watch_cd\":null,\"cntry_of_iss_cd\":\"CN\",\"sp_rating_dt\":null,\"eusd_tax_fl\":\"y\",\"currency_cd\":\"CNY\",\"withholding_tax\":null,\"orig_dated_dt\":\"2023-03-15 00:00:00.0\",\"exec_quote_fl\":\"n\",\"warrants_fl\":\"n\",\"sp_debt_class_cd\":null,\"private_place_fl\":\"n\",\"nsin_agn_cd\":\"ISN\",\"mtn_fl\":\"n\",\"denom_type_cd\":\"BKE\",\"euroclear_nm\":null,\"poison_put_fl\":\"n\",\"isin_src_cd\":null,\"trace_grade_cd\":null,\"asset_subtype_cd\":\"DMTC\",\"amt_iss_public\":null,\"asset_type_cd\":\"CORP\",\"defeased_fl\":\"n\",\"settle_bus_ctr_cd\":\"CN\",\"float_formula\":null,\"asset_last_chg_dt\":\"2023-03-08 09:42:00.0\",\"standard_yld_type_cd\":\"IS\",\"denom_incr\":\"100.0\",\"asset_info_src_cd\":\"RTR\",\"mdy_st_rtng_cd\":null,\"spec_put_fl\":\"n\",\"prin_idx_lnk_fl\":\"n\",\"guarantee_fl\":\"y\",\"pay_cal_val\":\"15\",\"fund_terms_fl\":\"y\",\"mdy_debt_class_cd\":null,\"pik_csh_pmt_dt\":null,\"bank_qualified_fl\":null,\"exp_maturity_dt\":null,\"secured_fl\":\"y\",\"for_settle_val\":null,\"next_mand_tender_dt\":null,\"fig_rule_cd\":\"C\",\"rtr_ticker\":\"SOGOVP\",\"rcs_class_cd\":\"BOND\",\"extend_terms_fl\":\"n\",\"preferred_ric\":null,\"ds_type_cd\":\"CORP\",\"inflation_protect_fl\":\"n\",\"cur_amt_out_dt\":\"2023-03-14 00:00:00.0\"}}}\r\n";

	@Test
	public void testMergeDsosJsonObject1() {
		JSONObject feedJsonObj = JsonConverterUtil.convertToSimpleJson(DSOS_FEED_JSON);
		String dbJson = "{\"govcorp\":{\"asset2\":{\"prtl_redemp_fl\":null,\"callable_notation\":null,\"repo_elig_id\":null,\"cusip_change_cd\":null,\"toggle_note_fl\":\"n\",\"instr_name\":\"% FIX CORP DUE 2030\",\"asset_id\":\"0x0010559d9dcf0288\",\"cur_cpn_class_cd\":\"TBP\",\"flip_opt_fl\":\"y\",\"straight_bond_fl\":\"n\",\"risk_country_cd\":null,\"sukuk_structure_fl\":null,\"prin_pay_redempt_cd\":null,\"fdic_insu_fl\":null,\"post_iss_icma_fl\":null,\"latest_iss_px\":\"100.0\",\"write_down_trigger_cd\":null,\"crd_compliance_fl\":null,\"dfrd_int_cnvrsn_dt\":null,\"trade_settle_curr_cd\":null,\"facility_amt\":null,\"aaoifi_compliant_fl\":null,\"hybrid_fl\":\"n\",\"next_par_call_dt\":null,\"odd_first_cpn_cd\":\"R\",\"liquidation_preference_cd\":\"SRS\",\"write_up_fl\":null,\"odd_first_cpn\":null,\"announcement_dt\":\"2023-03-08 04:00:00.0\",\"flip_opt_dt\":\"2026-03-15 00:00:00.0\",\"transition_bond_fl\":\"n\",\"green_bond_fl\":\"n\",\"sharia_opinion_fl\":null,\"gen_pay_rank_cd\":\"SSE\",\"conver_cd\":null,\"seniority_cd\":\"SR\",\"us_baby_bond_fl\":null,\"puttable_notation\":\"7np3(1x)\",\"orig_cusip_type_cd\":null,\"tax_credit_fl\":\"n\",\"cfi\":null,\"realtime_bond_type\":\"S\",\"debt_recourse_cd\":\"Y\",\"dtc_elig_fl\":null,\"us_section_13f_fl\":\"n\",\"trading_flat_fl\":null,\"esg_icma_fl\":null,\"odd_last_cpn_fl\":\"n\",\"esg_label_cd\":null,\"retail_sec_fl\":\"n\",\"eu_taxonomy_fl\":null,\"fisn\":null,\"series\":null,\"tlac_elig_fl\":null,\"div_stopper_fl\":null,\"facility\":null,\"ftt_liable_fl\":\"n\",\"next_par_call_px\":null,\"reoffered_dt\":null,\"src_of_pmt_cd\":null,\"over_subscription\":null,\"bailin_fl\":null,\"cur_rate_cd\":null,\"flip_opt_cd\":\"IO\",\"cav_maturity_amt\":null,\"esg_compliance_cd\":null,\"ftt_report_fl\":\"n\",\"org_of_risk_id\":null,\"latest_iss_dt\":\"2023-03-14 00:00:00.0\",\"cur_amt_factor\":\"1.0\",\"security_cd\":\"OTH\",\"odd_first_cpn_fl\":\"n\",\"div_pusher_fl\":null,\"ucits_compliance_fl\":null,\"prerefunded_fl\":null,\"structured_fl\":\"n\",\"term_to_maturity_yrs\":\"7Y\",\"reoffered_fl\":null,\"isa_eligible_fl\":\"y\",\"repo_elig_fl\":\"n\",\"rrps_ric_permid\":null,\"org_of_risk_audit_cd\":null,\"tier_capital_cd\":null,\"cic_cd\":\"CN29\",\"survivor_opt_fl\":\"n\",\"odd_last_cpn_cd\":\"R\",\"local_iss_dt\":null,\"write_down_trigg_ratio\":null,\"cdc_asset_class_cd\":null,\"letter_of_credit_fl\":\"n\",\"structured_cd\":null,\"estimated_free_cnv_fl\":null,\"borrower_id\":null,\"cusip_change_dt\":null,\"finra_sub_prdct_type_cd\":null,\"solvability_ratio\":null,\"cleanup_call_fl\":\"n\",\"cntry_of_risk_cd\":null,\"cur_int_defer_fl\":\"n\",\"risk_classifications_cd\":null,\"trade_asset_type_cd\":null,\"make_whole_call_fl\":\"n\",\"write_down_fl\":null,\"issue_id\":null,\"esg_bond_fl\":\"n\",\"calc_disable_rsn\":null,\"qdi_elig_fl\":\"n\",\"write_down_type_cd\":null,\"super_sinker_fl\":null,\"asset_eff_dt\":\"2023-03-14 00:00:00.0\",\"realtime_building_block\":\"CORP\",\"pgm_iss_fl\":\"n\",\"addl_credit_fl\":null,\"mrel_elig_fl\":null,\"drd_elig_fl\":\"n\",\"cap_cont_fl\":\"n\"},\"rduSecurities\":[{\"security\":{\"mic_opol\":{\"sedol_eff_dt\":null,\"opol_fl\":null,\"asset_id\":null,\"sedol\":null,\"sedol_end_dt\":null,\"mic_cd\":null}}}],\"asset\":{\"current_cpn\":null,\"wpk_nm\":null,\"funged_fl\":\"n\",\"bankwatch_rating_dt\":null,\"latest_rating_src_cd\":null,\"asset_id\":\"0x0010559d9dcf0288\",\"asset_status_cd\":\"TBP\",\"ibs_control_nm\":null,\"project_name\":null,\"emerging_market_fl\":\"y\",\"last_reset_dt\":null,\"mandatory_tender_dt\":null,\"mdy_rating_cd\":null,\"unit_cd\":null,\"next_sink_dt\":null,\"strip_total\":null,\"capitalization_fl\":\"n\",\"next_put_dt\":\"2026-03-15 00:00:00.0\",\"dom_settle_val\":\"1\",\"pay_freq_cd\":\"1\",\"mdy_rating_dt\":null,\"cur_prin_leg_nm\":\"1\",\"debt_svc_cd\":null,\"put_terms_fl\":\"y\",\"tot_prog_amt\":null,\"mdy_st_rtng_dt\":null,\"dcs_type_cd\":\"B\",\"next_pay_dt\":\"2024-03-15 00:00:00.0\",\"asset_setup_dt\":\"2023-03-08 04:00:00.0\",\"cur_amt_outsd\":\"500000.0\",\"trace_cd\":\"N\",\"next_reset_dt\":null,\"strippable_fl\":\"n\",\"day_count_cd\":\"5\",\"ibca_rating_dt\":null,\"rtfi_us_elig_cd\":\"UNS\",\"tap_end_dt\":null,\"status_of_document\":\"2\",\"exdiv_val\":null,\"asset_duplicate_cd\":null,\"valoren_nm\":null,\"life_cap\":null,\"pay_in_part_fl\":\"n\",\"oid_fl\":null,\"prospectus_dt\":\"2023-03-14 00:00:00.0\",\"mdy_watch_cd\":null,\"credit_sensitive_fl\":\"n\",\"dp_rating_dt\":null,\"lead_undwrt_cd\":\"HUC\",\"sp_rating_cd\":null,\"clawback_type_cd\":null,\"min_denom\":\"100.0\",\"call_terms_fl\":\"n\",\"call_type_cd\":null,\"mdy_watch_dt\":null,\"sp_st_rtng_cd\":null,\"nsin_nm\":null,\"float_mult\":null,\"min_credit_rating_cd\":\"AA\",\"native_yld_type_cd\":\"CB\",\"asset_ticker\":\"SOGOV\",\"fitch_rating_cd\":null,\"asset_templt_cd\":\"CC\",\"bankwatch_rating_cd\":null,\"annuity_fl\":\"n\",\"cpn_type_cd\":\"TBPD\",\"refund_dt\":null,\"status_eff_dt\":\"2023-03-08 00:00:00.0\",\"convertible_fl\":\"n\",\"tap_issue_fl\":\"n\",\"asset_permid\":\"232804226926\",\"latest_rating_eff_dt\":null,\"cur_amt_outsd_chg_cd\":\"ISS\",\"prosp_on_file_fl\":\"y\",\"sovr_class_cd\":null,\"sp_watch_dt\":null,\"dom_settle_cal_cd\":\"BDY\",\"last_cpn_dt\":\"2029-03-15 00:00:00.0\",\"redemption_val\":\"100.0\",\"orig_iss_dt\":\"2023-03-14 00:00:00.0\",\"record_dt_val\":null,\"stick_suppl_fl\":\"n\",\"exdiv_cal_cd\":null,\"multistep_flt_fl\":\"n\",\"dp_rating_cd\":null,\"float_offset\":null,\"cur_prin_curr_cd\":\"CNY\",\"secondary_insu_fl\":null,\"issuer_id\":\"0x00102c4c47b8149b\",\"record_dt_cd\":null,\"common_code_nm\":null,\"next_sink_amt\":null,\"orig_amt_iss\":\"500000.0\",\"series\":null,\"fitch_ibca_rating_cd\":null,\"tax_call_fl\":\"n\",\"asset_cf_corr_dt\":null,\"descr_detail\":null,\"er_score\":\"4\",\"prosp_suppl_dt\":null,\"rrps_ric\":null,\"domin_rating_cd\":null,\"exch_listed_fl\":\"y\",\"ibca_rating_cd\":null,\"next_call_px\":null,\"primary_quote_id\":null,\"fitch_rating_dt\":null,\"cusip\":null,\"pik_inkind_pmt_dt\":null,\"tax_status_cd\":null,\"equity_clawback_fl\":\"n\",\"amt_iss_tot\":\"500000.0\",\"next_call_dt\":null,\"physical_form_cd\":\"BKE\",\"isin_nm\":null,\"mtn_shelf_id\":null,\"full_bridge_symbol\":\"cn*;SOGOV-TBP-0330\",\"pik_fl\":\"n\",\"ds_subtype_cd\":\"CFIN\",\"life_floor\":null,\"domin_rating_dt\":null,\"fitch_ibca_rating_dt\":null,\"pay_cal_cd\":\"CDM\",\"first_cpn_dt\":\"2024-03-15 00:00:00.0\",\"maturity_dt\":\"2030-03-15 00:00:00.0\",\"dual_cur_fl\":\"n\",\"first_reset_dt\":null,\"cur_int_leg_nm\":\"1\",\"next_put_px\":\"100.0\",\"distribution_src_cd\":\"RTRI\",\"perpetual_fl\":\"n\",\"cpn_class_cd\":\"TBP\",\"latest_rating_cd\":null,\"sp_st_rtng_dt\":null,\"bridge_symbol\":\"SOGOV-TBP-0330\",\"dbs_pid\":\"110000B058RM4\",\"int_idx_lnk_fl\":null,\"float_index\":null,\"debt_type_cd\":\"CNENTERP\",\"prosp_suppl_nm\":null,\"sec_class_cd\":null,\"descr\":\"SOGOV        03/15/30 PUT\",\"sp_watch_cd\":null,\"cntry_of_iss_cd\":\"CN\",\"sp_rating_dt\":null,\"eusd_tax_fl\":\"y\",\"currency_cd\":\"CNY\",\"withholding_tax\":null,\"orig_dated_dt\":\"2023-03-15 00:00:00.0\",\"exec_quote_fl\":\"n\",\"warrants_fl\":\"n\",\"sp_debt_class_cd\":null,\"private_place_fl\":\"n\",\"nsin_agn_cd\":\"ISN\",\"mtn_fl\":\"n\",\"denom_type_cd\":\"BKE\",\"euroclear_nm\":null,\"poison_put_fl\":\"n\",\"isin_src_cd\":null,\"trace_grade_cd\":null,\"asset_subtype_cd\":\"DMTC\",\"amt_iss_public\":null,\"asset_type_cd\":\"CORP\",\"defeased_fl\":\"n\",\"settle_bus_ctr_cd\":\"CN\",\"float_formula\":null,\"asset_last_chg_dt\":\"2023-03-08 09:42:00.0\",\"standard_yld_type_cd\":\"IS\",\"denom_incr\":\"100.0\",\"asset_info_src_cd\":\"RTR\",\"mdy_st_rtng_cd\":null,\"spec_put_fl\":\"n\",\"prin_idx_lnk_fl\":\"n\",\"guarantee_fl\":\"y\",\"pay_cal_val\":\"15\",\"fund_terms_fl\":\"y\",\"mdy_debt_class_cd\":null,\"pik_csh_pmt_dt\":null,\"bank_qualified_fl\":null,\"exp_maturity_dt\":null,\"secured_fl\":\"y\",\"for_settle_val\":null,\"next_mand_tender_dt\":null,\"fig_rule_cd\":\"C\",\"rtr_ticker\":\"SOGOVP\",\"rcs_class_cd\":\"BOND\",\"extend_terms_fl\":\"n\",\"preferred_ric\":null,\"ds_type_cd\":\"CORP\",\"inflation_protect_fl\":\"n\",\"cur_amt_out_dt\":\"2023-03-14 00:00:00.0\"},\"id_obj_xref_hist\":[{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"CN*;SOGOV-TBP-0330\",\"obj_oid\":\"0x0010559d9dcf0288\",\"id_type_cd\":\"BDG\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2023-03-08 00:00:00.0\",\"obj_type_cd\":\"GCBD\",\"id_value\":\"cn*;SOGOV-TBP-0330\",\"global_region_cd\":\"A\"},{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"110000B058RM4\",\"obj_oid\":\"0x0010559d9dcf0288\",\"id_type_cd\":\"DBS\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2023-03-08 00:00:00.0\",\"obj_type_cd\":\"GCBD\",\"id_value\":\"110000B058RM4\",\"global_region_cd\":\"A\"}]}}";
		JSONObject dbJsonObj = JsonConverterUtil.convertToSimpleJson(dbJson);
		Record feedRecord = new Record();
		feedRecord.getRecordRawData().setRawData(feedJsonObj);
		Record mergedRecord = feedVsDbMergeService.merge(feedRecord, dbJsonObj);
		assertEquals("kushal", mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.asset2.fdic_insu_fl"));
		assertEquals("y", mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.asset2.flip_opt_fl"));
	}

	@Test
	public void testMergeDsosJsonObject() {
		JSONObject feedJsonObj = JsonConverterUtil.convertToSimpleJson(DSOS_FEED_JSON1);
		String dbJson = "{\"govcorp\":{\"asset2\":{\"prtl_redemp_fl\":null,\"callable_notation\":null,\"repo_elig_id\":null,\"cusip_change_cd\":null,\"toggle_note_fl\":\"n\",\"instr_name\":\"% FIX CORP DUE 2030\",\"asset_id\":\"0x0010559d9dcf0288\",\"cur_cpn_class_cd\":\"TBP\",\"straight_bond_fl\":\"n\",\"risk_country_cd\":null,\"sukuk_structure_fl\":null,\"prin_pay_redempt_cd\":null,\"fdic_insu_fl\":\"kushal\",\"post_iss_icma_fl\":null,\"latest_iss_px\":\"100.0\",\"write_down_trigger_cd\":null,\"crd_compliance_fl\":null,\"dfrd_int_cnvrsn_dt\":null,\"trade_settle_curr_cd\":null,\"facility_amt\":null,\"aaoifi_compliant_fl\":null,\"hybrid_fl\":\"n\",\"next_par_call_dt\":null,\"odd_first_cpn_cd\":\"R\",\"liquidation_preference_cd\":\"SRS\",\"write_up_fl\":null,\"odd_first_cpn\":null,\"announcement_dt\":\"2023-03-08 04:00:00.0\",\"flip_opt_dt\":\"2026-03-15 00:00:00.0\",\"transition_bond_fl\":\"n\",\"green_bond_fl\":\"n\",\"sharia_opinion_fl\":null,\"gen_pay_rank_cd\":\"SSE\",\"conver_cd\":null,\"seniority_cd\":\"SR\",\"us_baby_bond_fl\":null,\"puttable_notation\":\"7np3(1x)\",\"orig_cusip_type_cd\":null,\"tax_credit_fl\":\"n\",\"cfi\":null,\"realtime_bond_type\":\"S\",\"debt_recourse_cd\":\"Y\",\"dtc_elig_fl\":null,\"us_section_13f_fl\":\"n\",\"trading_flat_fl\":null,\"esg_icma_fl\":null,\"odd_last_cpn_fl\":\"n\",\"esg_label_cd\":null,\"retail_sec_fl\":\"n\",\"eu_taxonomy_fl\":null,\"fisn\":null,\"series\":null,\"tlac_elig_fl\":null,\"div_stopper_fl\":null,\"facility\":null,\"ftt_liable_fl\":\"n\",\"next_par_call_px\":null,\"reoffered_dt\":null,\"src_of_pmt_cd\":null,\"over_subscription\":null,\"bailin_fl\":null,\"cur_rate_cd\":null,\"flip_opt_cd\":\"IO\",\"cav_maturity_amt\":null,\"esg_compliance_cd\":null,\"ftt_report_fl\":\"n\",\"org_of_risk_id\":null,\"latest_iss_dt\":\"2023-03-14 00:00:00.0\",\"cur_amt_factor\":\"1.0\",\"security_cd\":\"OTH\",\"odd_first_cpn_fl\":\"n\",\"div_pusher_fl\":null,\"ucits_compliance_fl\":null,\"prerefunded_fl\":null,\"structured_fl\":\"n\",\"term_to_maturity_yrs\":\"7Y\",\"reoffered_fl\":null,\"isa_eligible_fl\":\"y\",\"repo_elig_fl\":\"n\",\"rrps_ric_permid\":null,\"org_of_risk_audit_cd\":null,\"tier_capital_cd\":null,\"cic_cd\":\"CN29\",\"survivor_opt_fl\":\"n\",\"odd_last_cpn_cd\":\"R\",\"local_iss_dt\":null,\"write_down_trigg_ratio\":null,\"cdc_asset_class_cd\":null,\"letter_of_credit_fl\":\"n\",\"structured_cd\":null,\"estimated_free_cnv_fl\":null,\"borrower_id\":null,\"cusip_change_dt\":null,\"finra_sub_prdct_type_cd\":null,\"solvability_ratio\":null,\"cleanup_call_fl\":\"n\",\"cntry_of_risk_cd\":null,\"cur_int_defer_fl\":\"n\",\"risk_classifications_cd\":null,\"trade_asset_type_cd\":null,\"make_whole_call_fl\":\"n\",\"write_down_fl\":null,\"issue_id\":null,\"esg_bond_fl\":\"n\",\"calc_disable_rsn\":null,\"qdi_elig_fl\":\"n\",\"write_down_type_cd\":null,\"super_sinker_fl\":null,\"asset_eff_dt\":\"2023-03-14 00:00:00.0\",\"realtime_building_block\":\"CORP\",\"pgm_iss_fl\":\"n\",\"addl_credit_fl\":null,\"mrel_elig_fl\":null,\"drd_elig_fl\":\"n\",\"cap_cont_fl\":\"n\"},\"asset\":{\"current_cpn\":null,\"wpk_nm\":null,\"funged_fl\":\"n\",\"bankwatch_rating_dt\":null,\"latest_rating_src_cd\":null,\"asset_id\":\"0x0010559d9dcf0288\",\"asset_status_cd\":\"TBP\",\"ibs_control_nm\":null,\"project_name\":null,\"emerging_market_fl\":\"y\",\"last_reset_dt\":null,\"mandatory_tender_dt\":null,\"mdy_rating_cd\":null,\"unit_cd\":null,\"next_sink_dt\":null,\"strip_total\":null,\"capitalization_fl\":\"n\",\"next_put_dt\":\"2026-03-15 00:00:00.0\",\"dom_settle_val\":\"1\",\"pay_freq_cd\":\"1\",\"mdy_rating_dt\":null,\"cur_prin_leg_nm\":\"1\",\"debt_svc_cd\":null,\"put_terms_fl\":\"y\",\"tot_prog_amt\":null,\"mdy_st_rtng_dt\":null,\"dcs_type_cd\":\"B\",\"next_pay_dt\":\"2024-03-15 00:00:00.0\",\"asset_setup_dt\":\"2023-03-08 04:00:00.0\",\"cur_amt_outsd\":\"500000.0\",\"trace_cd\":\"N\",\"next_reset_dt\":null,\"strippable_fl\":\"n\",\"day_count_cd\":\"5\",\"ibca_rating_dt\":null,\"rtfi_us_elig_cd\":\"UNS\",\"tap_end_dt\":null,\"status_of_document\":\"2\",\"exdiv_val\":null,\"asset_duplicate_cd\":null,\"valoren_nm\":null,\"life_cap\":null,\"pay_in_part_fl\":\"n\",\"oid_fl\":null,\"prospectus_dt\":\"2023-03-14 00:00:00.0\",\"mdy_watch_cd\":null,\"credit_sensitive_fl\":\"n\",\"dp_rating_dt\":null,\"lead_undwrt_cd\":\"HUC\",\"sp_rating_cd\":null,\"clawback_type_cd\":null,\"min_denom\":\"100.0\",\"call_terms_fl\":\"n\",\"call_type_cd\":null,\"mdy_watch_dt\":null,\"sp_st_rtng_cd\":null,\"nsin_nm\":null,\"float_mult\":null,\"min_credit_rating_cd\":\"AA\",\"native_yld_type_cd\":\"CB\",\"asset_ticker\":\"SOGOV\",\"fitch_rating_cd\":null,\"asset_templt_cd\":\"CC\",\"bankwatch_rating_cd\":null,\"annuity_fl\":\"n\",\"cpn_type_cd\":\"TBPD\",\"refund_dt\":null,\"status_eff_dt\":\"2023-03-08 00:00:00.0\",\"convertible_fl\":\"n\",\"tap_issue_fl\":\"n\",\"asset_permid\":\"232804226926\",\"latest_rating_eff_dt\":null,\"cur_amt_outsd_chg_cd\":\"ISS\",\"prosp_on_file_fl\":\"y\",\"sovr_class_cd\":null,\"sp_watch_dt\":null,\"dom_settle_cal_cd\":\"BDY\",\"last_cpn_dt\":\"2029-03-15 00:00:00.0\",\"redemption_val\":\"100.0\",\"orig_iss_dt\":\"2023-03-14 00:00:00.0\",\"record_dt_val\":null,\"stick_suppl_fl\":\"n\",\"exdiv_cal_cd\":null,\"multistep_flt_fl\":\"n\",\"dp_rating_cd\":null,\"float_offset\":null,\"cur_prin_curr_cd\":\"CNY\",\"secondary_insu_fl\":null,\"issuer_id\":\"0x00102c4c47b8149b\",\"record_dt_cd\":null,\"common_code_nm\":null,\"next_sink_amt\":null,\"orig_amt_iss\":\"500000.0\",\"series\":null,\"fitch_ibca_rating_cd\":null,\"tax_call_fl\":\"n\",\"asset_cf_corr_dt\":null,\"descr_detail\":null,\"er_score\":\"4\",\"prosp_suppl_dt\":null,\"rrps_ric\":null,\"domin_rating_cd\":null,\"exch_listed_fl\":\"y\",\"ibca_rating_cd\":null,\"next_call_px\":null,\"primary_quote_id\":null,\"fitch_rating_dt\":null,\"cusip\":null,\"pik_inkind_pmt_dt\":null,\"tax_status_cd\":null,\"equity_clawback_fl\":\"n\",\"amt_iss_tot\":\"500000.0\",\"next_call_dt\":null,\"physical_form_cd\":\"BKE\",\"isin_nm\":null,\"mtn_shelf_id\":null,\"full_bridge_symbol\":\"cn*;SOGOV-TBP-0330\",\"pik_fl\":\"n\",\"ds_subtype_cd\":\"CFIN\",\"life_floor\":null,\"domin_rating_dt\":null,\"fitch_ibca_rating_dt\":null,\"pay_cal_cd\":\"CDM\",\"first_cpn_dt\":\"2024-03-15 00:00:00.0\",\"maturity_dt\":\"2030-03-15 00:00:00.0\",\"dual_cur_fl\":\"n\",\"first_reset_dt\":null,\"cur_int_leg_nm\":\"1\",\"next_put_px\":\"100.0\",\"distribution_src_cd\":\"RTRI\",\"perpetual_fl\":\"n\",\"cpn_class_cd\":\"TBP\",\"latest_rating_cd\":null,\"sp_st_rtng_dt\":null,\"bridge_symbol\":\"SOGOV-TBP-0330\",\"dbs_pid\":\"110000B058RM4\",\"int_idx_lnk_fl\":null,\"float_index\":null,\"debt_type_cd\":\"CNENTERP\",\"prosp_suppl_nm\":null,\"sec_class_cd\":null,\"descr\":\"SOGOV        03/15/30 PUT\",\"sp_watch_cd\":null,\"cntry_of_iss_cd\":\"CN\",\"sp_rating_dt\":null,\"eusd_tax_fl\":\"y\",\"currency_cd\":\"CNY\",\"withholding_tax\":null,\"orig_dated_dt\":\"2023-03-15 00:00:00.0\",\"exec_quote_fl\":\"n\",\"warrants_fl\":\"n\",\"sp_debt_class_cd\":null,\"private_place_fl\":\"n\",\"nsin_agn_cd\":\"ISN\",\"mtn_fl\":\"n\",\"denom_type_cd\":\"BKE\",\"euroclear_nm\":null,\"poison_put_fl\":\"n\",\"isin_src_cd\":null,\"trace_grade_cd\":null,\"asset_subtype_cd\":\"DMTC\",\"amt_iss_public\":null,\"asset_type_cd\":\"CORP\",\"defeased_fl\":\"n\",\"settle_bus_ctr_cd\":\"CN\",\"float_formula\":null,\"asset_last_chg_dt\":\"2023-03-08 09:42:00.0\",\"standard_yld_type_cd\":\"IS\",\"denom_incr\":\"100.0\",\"asset_info_src_cd\":\"RTR\",\"mdy_st_rtng_cd\":null,\"spec_put_fl\":\"n\",\"prin_idx_lnk_fl\":\"n\",\"guarantee_fl\":\"y\",\"pay_cal_val\":\"15\",\"fund_terms_fl\":\"y\",\"mdy_debt_class_cd\":null,\"pik_csh_pmt_dt\":null,\"bank_qualified_fl\":null,\"exp_maturity_dt\":null,\"secured_fl\":\"y\",\"for_settle_val\":null,\"next_mand_tender_dt\":null,\"fig_rule_cd\":\"C\",\"rtr_ticker\":\"SOGOVP\",\"rcs_class_cd\":\"BOND\",\"extend_terms_fl\":\"n\",\"preferred_ric\":null,\"ds_type_cd\":\"CORP\",\"inflation_protect_fl\":\"n\",\"cur_amt_out_dt\":\"2023-03-14 00:00:00.0\"}}}";
		JSONObject dbJsonObj = JsonConverterUtil.convertToSimpleJson(dbJson);
		Record feedRecord = new Record();
		feedRecord.getRecordRawData().setRawData(feedJsonObj);
		Record mergedRecord = feedVsDbMergeService.merge(feedRecord, dbJsonObj);
		assertNull(mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.asset2.fdic_insu_fl"));
		assertEquals("y", mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.asset2.flip_opt_fl"));
	}

	@Test
	public void testMergeArrayObject() {
		String dbJson = "{\"govcorp\":{\"asset2\":{\"prtl_redemp_fl\":null,\"callable_notation\":\"Pnc5(Cont)\",\"repo_elig_id\":null,\"cusip_change_cd\":null,\"toggle_note_fl\":\"n\",\"instr_name\":\"9% Ser A Cummltive Pref Stck\",\"asset_id\":\"00102CA62BF10F4F\",\"cur_cpn_class_cd\":\"FIX\",\"flip_opt_fl\":\"n\",\"straight_bond_fl\":\"n\",\"risk_country_cd\":null,\"sukuk_structure_fl\":null,\"prin_pay_redempt_cd\":null,\"fdic_insu_fl\":null,\"post_iss_icma_fl\":null,\"latest_iss_px\":\"100.0\",\"write_down_trigger_cd\":null,\"crd_compliance_fl\":null,\"dfrd_int_cnvrsn_dt\":null,\"trade_settle_curr_cd\":null,\"facility_amt\":null,\"aaoifi_compliant_fl\":null,\"hybrid_fl\":\"y\",\"next_par_call_dt\":null,\"odd_first_cpn_cd\":\"S\",\"liquidation_preference_cd\":\"SUBP\",\"write_up_fl\":null,\"odd_first_cpn\":null,\"announcement_dt\":\"1994-07-27 00:00:00.0\",\"flip_opt_dt\":null,\"transition_bond_fl\":\"n\",\"green_bond_fl\":\"n\",\"sharia_opinion_fl\":null,\"gen_pay_rank_cd\":\"PRS\",\"conver_cd\":null,\"seniority_cd\":\"SUB\",\"us_baby_bond_fl\":null,\"puttable_notation\":null,\"orig_cusip_type_cd\":null,\"tax_credit_fl\":\"n\",\"cfi\":\"EPXXXX\",\"realtime_bond_type\":\"S\",\"debt_recourse_cd\":\"Y\",\"dtc_elig_fl\":\"y\",\"us_section_13f_fl\":\"n\",\"trading_flat_fl\":null,\"esg_icma_fl\":null,\"odd_last_cpn_fl\":null,\"esg_label_cd\":null,\"retail_sec_fl\":\"n\",\"eu_taxonomy_fl\":null,\"fisn\":\"ENRON CAP RESOU/9% PFD SH S A\",\"series\":\"A\",\"tlac_elig_fl\":null,\"div_stopper_fl\":null,\"facility\":null,\"ftt_liable_fl\":\"n\",\"next_par_call_px\":null,\"reoffered_dt\":null,\"src_of_pmt_cd\":null,\"over_subscription\":null,\"bailin_fl\":null,\"cur_rate_cd\":\"N\",\"flip_opt_cd\":null,\"cav_maturity_amt\":null,\"esg_compliance_cd\":null,\"ftt_report_fl\":\"n\",\"org_of_risk_id\":null,\"latest_iss_dt\":\"1994-08-03 00:00:00.0\",\"cur_amt_factor\":\"1.0\",\"security_cd\":null,\"odd_first_cpn_fl\":\"y\",\"div_pusher_fl\":null,\"ucits_compliance_fl\":null,\"prerefunded_fl\":null,\"structured_fl\":\"n\",\"term_to_maturity_yrs\":null,\"reoffered_fl\":null,\"isa_eligible_fl\":\"n\",\"repo_elig_fl\":\"n\",\"rrps_ric_permid\":\"46662001051\",\"org_of_risk_audit_cd\":null,\"tier_capital_cd\":null,\"cic_cd\":\"US34\",\"survivor_opt_fl\":\"n\",\"odd_last_cpn_cd\":null,\"local_iss_dt\":null,\"write_down_trigg_ratio\":null,\"cdc_asset_class_cd\":null,\"letter_of_credit_fl\":\"n\",\"structured_cd\":null,\"estimated_free_cnv_fl\":null,\"borrower_id\":null,\"cusip_change_dt\":null,\"finra_sub_prdct_type_cd\":null,\"solvability_ratio\":null,\"cleanup_call_fl\":\"n\",\"cntry_of_risk_cd\":null,\"cur_int_defer_fl\":\"n\",\"risk_classifications_cd\":null,\"trade_asset_type_cd\":null,\"make_whole_call_fl\":\"n\",\"write_down_fl\":null,\"issue_id\":null,\"esg_bond_fl\":\"n\",\"calc_disable_rsn\":null,\"qdi_elig_fl\":\"n\",\"write_down_type_cd\":null,\"super_sinker_fl\":null,\"asset_eff_dt\":\"1994-08-03 00:00:00.0\",\"realtime_building_block\":\"CORP\",\"pgm_iss_fl\":\"n\",\"addl_credit_fl\":null,\"mrel_elig_fl\":null,\"drd_elig_fl\":\"n\",\"cap_cont_fl\":\"n\"},\"rduSecurities\":[{\"security\":{\"mic_opol\":{\"sedol_eff_dt\":\"2018-04-20 00:00:00.0\",\"opol_fl\":\"y\",\"asset_id\":\"00102CA62BF10F4F\",\"sedol\":\"2315995\",\"sedol_end_dt\":null,\"mic_cd\":\"OTCM\"}}}],\"asset\":{\"current_cpn\":\"9.0\",\"wpk_nm\":null,\"funged_fl\":\"n\",\"bankwatch_rating_dt\":null,\"latest_rating_src_cd\":null,\"asset_id\":\"00102CA62BF10F4F\",\"asset_status_cd\":\"DEF\",\"ibs_control_nm\":\"1216536\",\"project_name\":null,\"emerging_market_fl\":\"n\",\"last_reset_dt\":null,\"mandatory_tender_dt\":null,\"mdy_rating_cd\":null,\"unit_cd\":null,\"next_sink_dt\":null,\"strip_total\":null,\"capitalization_fl\":\"n\",\"next_put_dt\":null,\"dom_settle_val\":\"2\",\"pay_freq_cd\":\"12\",\"mdy_rating_dt\":null,\"cur_prin_leg_nm\":\"1\",\"debt_svc_cd\":null,\"put_terms_fl\":\"n\",\"tot_prog_amt\":null,\"mdy_st_rtng_dt\":null,\"dcs_type_cd\":\"B\",\"next_pay_dt\":null,\"asset_setup_dt\":\"2017-10-20 09:42:00.0\",\"cur_amt_outsd\":\"75000.0\",\"trace_cd\":\"N\",\"next_reset_dt\":null,\"strippable_fl\":\"n\",\"day_count_cd\":\"1\",\"ibca_rating_dt\":null,\"rtfi_us_elig_cd\":\"USA\",\"tap_end_dt\":null,\"status_of_document\":\"1\",\"exdiv_val\":null,\"asset_duplicate_cd\":null,\"valoren_nm\":null,\"life_cap\":null,\"pay_in_part_fl\":\"n\",\"oid_fl\":null,\"prospectus_dt\":\"1994-07-27 00:00:00.0\",\"mdy_watch_cd\":null,\"credit_sensitive_fl\":\"n\",\"dp_rating_dt\":null,\"lead_undwrt_cd\":null,\"sp_rating_cd\":null,\"clawback_type_cd\":null,\"min_denom\":\"25.0\",\"call_terms_fl\":\"y\",\"call_type_cd\":\"CSH\",\"mdy_watch_dt\":null,\"sp_st_rtng_cd\":null,\"nsin_nm\":\"29357D208\",\"float_mult\":null,\"min_credit_rating_cd\":\"NR\",\"native_yld_type_cd\":\"CB\",\"asset_ticker\":\"ENRCL\",\"fitch_rating_cd\":null,\"asset_templt_cd\":\"CC\",\"bankwatch_rating_cd\":null,\"annuity_fl\":\"n\",\"cpn_type_cd\":\"FXPV\",\"refund_dt\":null,\"status_eff_dt\":\"2001-12-02 00:00:00.0\",\"convertible_fl\":\"n\",\"tap_issue_fl\":\"n\",\"asset_permid\":\"8589977507\",\"latest_rating_eff_dt\":null,\"cur_amt_outsd_chg_cd\":\"ISS\",\"prosp_on_file_fl\":\"n\",\"sovr_class_cd\":null,\"sp_watch_dt\":null,\"dom_settle_cal_cd\":\"BDY\",\"last_cpn_dt\":null,\"redemption_val\":null,\"orig_iss_dt\":\"1994-08-03 00:00:00.0\",\"record_dt_val\":\"1\",\"stick_suppl_fl\":\"n\",\"exdiv_cal_cd\":null,\"multistep_flt_fl\":\"n\",\"dp_rating_cd\":null,\"float_offset\":null,\"cur_prin_curr_cd\":\"USD\",\"secondary_insu_fl\":\"n\",\"issuer_id\":\"0002A00027184AD7\",\"record_dt_cd\":\"BDP\",\"common_code_nm\":null,\"next_sink_amt\":null,\"orig_amt_iss\":\"75000.0\",\"series\":\"A\",\"fitch_ibca_rating_cd\":null,\"tax_call_fl\":\"n\",\"asset_cf_corr_dt\":null,\"descr_detail\":null,\"er_score\":\"4\",\"prosp_suppl_dt\":null,\"rrps_ric\":\"29357D208u003dRRPS\",\"domin_rating_cd\":null,\"exch_listed_fl\":\"n\",\"ibca_rating_cd\":null,\"next_call_px\":null,\"primary_quote_id\":null,\"fitch_rating_dt\":null,\"cusip\":\"29357D208\",\"pik_inkind_pmt_dt\":null,\"tax_status_cd\":null,\"equity_clawback_fl\":\"n\",\"amt_iss_tot\":\"75000.0\",\"next_call_dt\":null,\"physical_form_cd\":\"REG\",\"isin_nm\":\"US29357D2080\",\"mtn_shelf_id\":null,\"full_bridge_symbol\":\"us*;ENRCL-9-PRP\",\"pik_fl\":\"n\",\"ds_subtype_cd\":\"CFIN\",\"life_floor\":null,\"domin_rating_dt\":null,\"fitch_ibca_rating_dt\":null,\"pay_cal_cd\":\"EOM\",\"first_cpn_dt\":\"1994-08-31 00:00:00.0\",\"maturity_dt\":null,\"dual_cur_fl\":\"n\",\"first_reset_dt\":null,\"cur_int_leg_nm\":\"1\",\"next_put_px\":null,\"distribution_src_cd\":\"BDGU\",\"perpetual_fl\":\"y\",\"cpn_class_cd\":\"FIX\",\"latest_rating_cd\":null,\"sp_st_rtng_dt\":null,\"bridge_symbol\":\"ENRCL-9-PRP\",\"dbs_pid\":\"110000B02NWEG\",\"int_idx_lnk_fl\":null,\"float_index\":null,\"debt_type_cd\":\"PFDSTK\",\"prosp_suppl_nm\":null,\"sec_class_cd\":null,\"descr\":\"ENRCL  9.000 Perp     DFTd\",\"sp_watch_cd\":null,\"cntry_of_iss_cd\":\"US\",\"sp_rating_dt\":null,\"eusd_tax_fl\":\"n\",\"currency_cd\":\"USD\",\"withholding_tax\":null,\"orig_dated_dt\":\"1994-08-03 00:00:00.0\",\"exec_quote_fl\":\"n\",\"warrants_fl\":\"n\",\"sp_debt_class_cd\":null,\"private_place_fl\":\"n\",\"nsin_agn_cd\":\"CSP\",\"mtn_fl\":\"n\",\"denom_type_cd\":\"BKE\",\"euroclear_nm\":null,\"poison_put_fl\":\"n\",\"isin_src_cd\":null,\"trace_grade_cd\":null,\"asset_subtype_cd\":\"DMTC\",\"amt_iss_public\":null,\"asset_type_cd\":\"CORP\",\"defeased_fl\":\"n\",\"settle_bus_ctr_cd\":\"USBM\",\"float_formula\":null,\"asset_last_chg_dt\":\"2022-06-16 22:59:00.0\",\"standard_yld_type_cd\":\"CB\",\"denom_incr\":\"25.0\",\"asset_info_src_cd\":\"RTR\",\"mdy_st_rtng_cd\":null,\"spec_put_fl\":\"n\",\"prin_idx_lnk_fl\":\"n\",\"guarantee_fl\":\"n\",\"pay_cal_val\":null,\"fund_terms_fl\":\"n\",\"mdy_debt_class_cd\":null,\"pik_csh_pmt_dt\":null,\"bank_qualified_fl\":\"n\",\"exp_maturity_dt\":null,\"secured_fl\":\"n\",\"for_settle_val\":null,\"next_mand_tender_dt\":null,\"fig_rule_cd\":\"C\",\"rtr_ticker\":\"ENRCL\",\"rcs_class_cd\":\"PFSH\",\"extend_terms_fl\":\"n\",\"preferred_ric\":null,\"ds_type_cd\":\"CORP\",\"inflation_protect_fl\":\"n\",\"cur_amt_out_dt\":\"1994-08-03 00:00:00.0\"},\"id_obj_xref_hist\":[{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"1216536\",\"obj_oid\":\"00102CA62BF10F4F\",\"id_type_cd\":\"IDI\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2017-10-20 00:00:00.0\",\"obj_type_cd\":\"GCBD\",\"id_value\":\"1216536\",\"global_region_cd\":\"N\"},{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"29357D208\",\"obj_oid\":\"00102CA62BF10F4F\",\"id_type_cd\":\"CSP\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2017-10-20 00:00:00.0\",\"obj_type_cd\":\"GCBD\",\"id_value\":\"29357D208\",\"global_region_cd\":\"N\"}]}}";
		String DSOSFeedData = "{\"govcorp\":{\"asset2\":{\"prtl_redemp_fl\":null,\"callable_notation\":\"Pnc5(Cont)\",\"repo_elig_id\":null,\"cusip_change_cd\":null,\"toggle_note_fl\":\"n\",\"instr_name\":\"9% Ser A Cummltive Pref Stck\",\"asset_id\":\"00102CA62BF10F4F\",\"cur_cpn_class_cd\":\"FIX\",\"flip_opt_fl\":\"n\",\"straight_bond_fl\":\"n\",\"risk_country_cd\":null,\"sukuk_structure_fl\":null,\"prin_pay_redempt_cd\":null,\"fdic_insu_fl\":null,\"post_iss_icma_fl\":null,\"latest_iss_px\":\"100.0\",\"write_down_trigger_cd\":null,\"crd_compliance_fl\":null,\"dfrd_int_cnvrsn_dt\":null,\"trade_settle_curr_cd\":null,\"facility_amt\":null,\"aaoifi_compliant_fl\":null,\"hybrid_fl\":\"y\",\"next_par_call_dt\":null,\"odd_first_cpn_cd\":\"S\",\"liquidation_preference_cd\":\"SUBP\",\"write_up_fl\":null,\"odd_first_cpn\":null,\"announcement_dt\":\"1994-07-27 00:00:00.0\",\"flip_opt_dt\":null,\"transition_bond_fl\":\"n\",\"green_bond_fl\":\"n\",\"sharia_opinion_fl\":null,\"gen_pay_rank_cd\":\"PRS\",\"conver_cd\":null,\"seniority_cd\":\"SUB\",\"us_baby_bond_fl\":null,\"puttable_notation\":null,\"orig_cusip_type_cd\":null,\"tax_credit_fl\":\"n\",\"cfi\":\"EPXXXX\",\"realtime_bond_type\":\"S\",\"debt_recourse_cd\":\"Y\",\"dtc_elig_fl\":\"y\",\"us_section_13f_fl\":\"n\",\"trading_flat_fl\":null,\"esg_icma_fl\":null,\"odd_last_cpn_fl\":null,\"esg_label_cd\":null,\"retail_sec_fl\":\"n\",\"eu_taxonomy_fl\":null,\"fisn\":\"ENRON CAP RESOU/9% PFD SH S A\",\"series\":\"A\",\"tlac_elig_fl\":null,\"div_stopper_fl\":null,\"facility\":null,\"ftt_liable_fl\":\"n\",\"next_par_call_px\":null,\"reoffered_dt\":null,\"src_of_pmt_cd\":null,\"over_subscription\":null,\"bailin_fl\":null,\"cur_rate_cd\":\"N\",\"flip_opt_cd\":null,\"cav_maturity_amt\":null,\"esg_compliance_cd\":null,\"ftt_report_fl\":\"n\",\"org_of_risk_id\":null,\"latest_iss_dt\":\"1994-08-03 00:00:00.0\",\"cur_amt_factor\":\"1.0\",\"security_cd\":null,\"odd_first_cpn_fl\":\"y\",\"div_pusher_fl\":null,\"ucits_compliance_fl\":null,\"prerefunded_fl\":null,\"structured_fl\":\"n\",\"term_to_maturity_yrs\":null,\"reoffered_fl\":null,\"isa_eligible_fl\":\"n\",\"repo_elig_fl\":\"n\",\"rrps_ric_permid\":\"46662001051\",\"org_of_risk_audit_cd\":null,\"tier_capital_cd\":null,\"cic_cd\":\"US34\",\"survivor_opt_fl\":\"n\",\"odd_last_cpn_cd\":null,\"local_iss_dt\":null,\"write_down_trigg_ratio\":null,\"cdc_asset_class_cd\":null,\"letter_of_credit_fl\":\"n\",\"structured_cd\":null,\"estimated_free_cnv_fl\":null,\"borrower_id\":null,\"cusip_change_dt\":null,\"finra_sub_prdct_type_cd\":null,\"solvability_ratio\":null,\"cleanup_call_fl\":\"n\",\"cntry_of_risk_cd\":null,\"cur_int_defer_fl\":\"n\",\"risk_classifications_cd\":null,\"trade_asset_type_cd\":null,\"make_whole_call_fl\":\"n\",\"write_down_fl\":null,\"issue_id\":null,\"esg_bond_fl\":\"n\",\"calc_disable_rsn\":null,\"qdi_elig_fl\":\"n\",\"write_down_type_cd\":null,\"super_sinker_fl\":null,\"asset_eff_dt\":\"1994-08-03 00:00:00.0\",\"realtime_building_block\":\"CORP\",\"pgm_iss_fl\":\"n\",\"addl_credit_fl\":null,\"mrel_elig_fl\":null,\"drd_elig_fl\":\"n\",\"cap_cont_fl\":\"n\"},\"rduSecurities\":[{\"security\":{\"mic_opol\":{\"sedol_eff_dt\":\"2018-04-20 00:00:00.0\",\"opol_fl\":\"n\",\"asset_id\":\"00102CA62BF10F4F\",\"sedol\":\"2315995\",\"sedol_end_dt\":null,\"mic_cd\":\"OTCM\"}}}],\"asset\":{\"current_cpn\":\"9.0\",\"wpk_nm\":null,\"funged_fl\":\"n\",\"bankwatch_rating_dt\":null,\"latest_rating_src_cd\":null,\"asset_id\":\"00102CA62BF10F4F\",\"asset_status_cd\":\"DEF\",\"ibs_control_nm\":\"1216536\",\"project_name\":null,\"emerging_market_fl\":\"n\",\"last_reset_dt\":null,\"mandatory_tender_dt\":null,\"mdy_rating_cd\":null,\"unit_cd\":null,\"next_sink_dt\":null,\"strip_total\":null,\"capitalization_fl\":\"n\",\"next_put_dt\":null,\"dom_settle_val\":\"2\",\"pay_freq_cd\":\"12\",\"mdy_rating_dt\":null,\"cur_prin_leg_nm\":\"1\",\"debt_svc_cd\":null,\"put_terms_fl\":\"n\",\"tot_prog_amt\":null,\"mdy_st_rtng_dt\":null,\"dcs_type_cd\":\"B\",\"next_pay_dt\":null,\"asset_setup_dt\":\"2017-10-20 09:42:00.0\",\"cur_amt_outsd\":\"75000.0\",\"trace_cd\":\"N\",\"next_reset_dt\":null,\"strippable_fl\":\"n\",\"day_count_cd\":\"1\",\"ibca_rating_dt\":null,\"rtfi_us_elig_cd\":\"USA\",\"tap_end_dt\":null,\"status_of_document\":\"1\",\"exdiv_val\":null,\"asset_duplicate_cd\":null,\"valoren_nm\":null,\"life_cap\":null,\"pay_in_part_fl\":\"n\",\"oid_fl\":null,\"prospectus_dt\":\"1994-07-27 00:00:00.0\",\"mdy_watch_cd\":null,\"credit_sensitive_fl\":\"n\",\"dp_rating_dt\":null,\"lead_undwrt_cd\":null,\"sp_rating_cd\":null,\"clawback_type_cd\":null,\"min_denom\":\"25.0\",\"call_terms_fl\":\"y\",\"call_type_cd\":\"CSH\",\"mdy_watch_dt\":null,\"sp_st_rtng_cd\":null,\"nsin_nm\":\"29357D208\",\"float_mult\":null,\"min_credit_rating_cd\":\"NR\",\"native_yld_type_cd\":\"CB\",\"asset_ticker\":\"ENRCL\",\"fitch_rating_cd\":null,\"asset_templt_cd\":\"CC\",\"bankwatch_rating_cd\":null,\"annuity_fl\":\"n\",\"cpn_type_cd\":\"FXPV\",\"refund_dt\":null,\"status_eff_dt\":\"2001-12-02 00:00:00.0\",\"convertible_fl\":\"n\",\"tap_issue_fl\":\"n\",\"asset_permid\":\"8589977507\",\"latest_rating_eff_dt\":null,\"cur_amt_outsd_chg_cd\":\"ISS\",\"prosp_on_file_fl\":\"n\",\"sovr_class_cd\":null,\"sp_watch_dt\":null,\"dom_settle_cal_cd\":\"BDY\",\"last_cpn_dt\":null,\"redemption_val\":null,\"orig_iss_dt\":\"1994-08-03 00:00:00.0\",\"record_dt_val\":\"1\",\"stick_suppl_fl\":\"n\",\"exdiv_cal_cd\":null,\"multistep_flt_fl\":\"n\",\"dp_rating_cd\":null,\"float_offset\":null,\"cur_prin_curr_cd\":\"USD\",\"secondary_insu_fl\":\"n\",\"issuer_id\":\"0002A00027184AD7\",\"record_dt_cd\":\"BDP\",\"common_code_nm\":null,\"next_sink_amt\":null,\"orig_amt_iss\":\"75000.0\",\"series\":\"A\",\"fitch_ibca_rating_cd\":null,\"tax_call_fl\":\"n\",\"asset_cf_corr_dt\":null,\"descr_detail\":null,\"er_score\":\"4\",\"prosp_suppl_dt\":null,\"rrps_ric\":\"29357D208u003dRRPS\",\"domin_rating_cd\":null,\"exch_listed_fl\":\"n\",\"ibca_rating_cd\":null,\"next_call_px\":null,\"primary_quote_id\":null,\"fitch_rating_dt\":null,\"cusip\":\"29357D208\",\"pik_inkind_pmt_dt\":null,\"tax_status_cd\":null,\"equity_clawback_fl\":\"n\",\"amt_iss_tot\":\"75000.0\",\"next_call_dt\":null,\"physical_form_cd\":\"REG\",\"isin_nm\":\"US29357D2080\",\"mtn_shelf_id\":null,\"full_bridge_symbol\":\"us*;ENRCL-9-PRP\",\"pik_fl\":\"n\",\"ds_subtype_cd\":\"CFIN\",\"life_floor\":null,\"domin_rating_dt\":null,\"fitch_ibca_rating_dt\":null,\"pay_cal_cd\":\"EOM\",\"first_cpn_dt\":\"1994-08-31 00:00:00.0\",\"maturity_dt\":null,\"dual_cur_fl\":\"n\",\"first_reset_dt\":null,\"cur_int_leg_nm\":\"1\",\"next_put_px\":null,\"distribution_src_cd\":\"BDGU\",\"perpetual_fl\":\"y\",\"cpn_class_cd\":\"FIX\",\"latest_rating_cd\":null,\"sp_st_rtng_dt\":null,\"bridge_symbol\":\"ENRCL-9-PRP\",\"dbs_pid\":\"110000B02NWEG\",\"int_idx_lnk_fl\":null,\"float_index\":null,\"debt_type_cd\":\"PFDSTK\",\"prosp_suppl_nm\":null,\"sec_class_cd\":null,\"descr\":\"ENRCL  9.000 Perp     DFTd\",\"sp_watch_cd\":null,\"cntry_of_iss_cd\":\"US\",\"sp_rating_dt\":null,\"eusd_tax_fl\":\"n\",\"currency_cd\":\"USD\",\"withholding_tax\":null,\"orig_dated_dt\":\"1994-08-03 00:00:00.0\",\"exec_quote_fl\":\"n\",\"warrants_fl\":\"n\",\"sp_debt_class_cd\":null,\"private_place_fl\":\"n\",\"nsin_agn_cd\":\"CSP\",\"mtn_fl\":\"n\",\"denom_type_cd\":\"BKE\",\"euroclear_nm\":null,\"poison_put_fl\":\"n\",\"isin_src_cd\":null,\"trace_grade_cd\":null,\"asset_subtype_cd\":\"DMTC\",\"amt_iss_public\":null,\"asset_type_cd\":\"CORP\",\"defeased_fl\":\"n\",\"settle_bus_ctr_cd\":\"USBM\",\"float_formula\":null,\"asset_last_chg_dt\":\"2022-06-16 22:59:00.0\",\"standard_yld_type_cd\":\"CB\",\"denom_incr\":\"25.0\",\"asset_info_src_cd\":\"RTR\",\"mdy_st_rtng_cd\":null,\"spec_put_fl\":\"n\",\"prin_idx_lnk_fl\":\"n\",\"guarantee_fl\":\"n\",\"pay_cal_val\":null,\"fund_terms_fl\":\"n\",\"mdy_debt_class_cd\":null,\"pik_csh_pmt_dt\":null,\"bank_qualified_fl\":\"n\",\"exp_maturity_dt\":null,\"secured_fl\":\"n\",\"for_settle_val\":null,\"next_mand_tender_dt\":null,\"fig_rule_cd\":\"C\",\"rtr_ticker\":\"ENRCL\",\"rcs_class_cd\":\"PFSH\",\"extend_terms_fl\":\"n\",\"preferred_ric\":null,\"ds_type_cd\":\"CORP\",\"inflation_protect_fl\":\"n\",\"cur_amt_out_dt\":\"1994-08-03 00:00:00.0\"},\"id_obj_xref_hist\":[{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"29357D208\",\"obj_oid\":\"00102CA62BF10F4F\",\"id_type_cd\":\"CSP\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2017-10-20 00:00:00.0\",\"obj_type_cd\":\"GCBD\",\"id_value\":\"29357D208\",\"global_region_cd\":\"Y\"}]}}";
		JSONObject feedJsonObj = JsonConverterUtil.convertToSimpleJson(DSOSFeedData);
		JSONObject dbJsonObj = JsonConverterUtil.convertToSimpleJson(dbJson);
		Record feedRecord = new Record();
		feedRecord.getRecordRawData().setRawData(feedJsonObj);
		Record mergedRecord = feedVsDbMergeService.merge(feedRecord, dbJsonObj);
		assertNull(mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.asset2.fdic_insu_fl"));
		assertEquals("Y", mergedRecord.getRecordRawData()
				.getRawDataAttribute("$.govcorp.id_obj_xref_hist[?(@.id_value == '29357D208' )].global_region_cd"));
		assertEquals("n", mergedRecord.getRecordRawData().getRawDataAttribute(
				"$.govcorp.rduSecurities[?(@.security.mic_opol.asset_id == '00102CA62BF10F4F')].security.mic_opol.opol_fl"));
	}

	@Test
	public void testMergeArrayQuoteObjTest() {
		String dbJson = "{\"govcorp\":{\"rduSecurities\":[{\"security\":{\"quote\":{\"pe\":null,\"quote_id\":\"0x000405003ea267fa\",\"currency_cd\":null,\"quote_permid\":\"34483976294\",\"asset_id\":\"0x0003f9016656c00b\",\"idn_contrib_cd\":null,\"price_src_cd\":\"EJV\",\"active_fl\":\"y\"},\"id_obj_xref_hist\":{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"PT036516054=RRPS\",\"obj_oid\":\"0x000405003ea267fa\",\"id_type_cd\":\"ORC\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2008-05-27 00:00:00.0\",\"obj_type_cd\":\"GCQU\",\"id_value\":\"PT036516054=RRPS\",\"global_region_cd\":\"E\"}}}]}}";
		String DSOSFeedData = "{\"govcorp\":{\"rduSecurities\":[{\"security\":{\"quote\":{\"pe\":null,\"quote_id\":\"0x000405003ea267fa\",\"currency_cd\":null,\"quote_permid\":\"34483976294\",\"asset_id\":\"0x0003f9016656c00b\",\"idn_contrib_cd\":null,\"price_src_cd\":\"EJV\",\"active_fl\":\"n\"},\"id_obj_xref_hist\":{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"PT036516054=RRPS\",\"obj_oid\":\"0x000405003ea267fa\",\"id_type_cd\":\"ORC\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2008-05-27 00:00:00.0\",\"obj_type_cd\":\"GCQU\",\"id_value\":\"PT036516054=RRPS\",\"global_region_cd\":\"E\"}}}]}}";
		JSONObject feedJsonObj = JsonConverterUtil.convertToSimpleJson(DSOSFeedData);
		JSONObject dbJsonObj = JsonConverterUtil.convertToSimpleJson(dbJson);
		Record feedRecord = new Record();
		feedRecord.getRecordRawData().setRawData(feedJsonObj);
		Record mergedRecord = feedVsDbMergeService.merge(feedRecord, dbJsonObj);
		assertEquals("n", mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.rduSecurities[?(@.security.quote.asset_id == '0x0003f9016656c00b' )].security.quote.active_fl"));
	}

	@Test
	public void testMergeArrayQuoteObjTest_CompleteReplaceIdXrefObjectHist() {
		String dbJson = "{\"govcorp\":{\"rduSecurities\":[{\"security\":{\"quote\":{\"pe\":null,\"quote_id\":\"0x000405003ea267fa\",\"currency_cd\":null,\"quote_permid\":\"34483976294\",\"asset_id\":\"0x0003f9016656c00b\",\"idn_contrib_cd\":null,\"price_src_cd\":\"EJV\",\"active_fl\":\"y\"},\"id_obj_xref_hist\":[{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"PT036516054=RRPS\",\"obj_oid\":\"0x000405003ea267fa\",\"id_type_cd\":\"ORC\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2008-05-27 00:00:00.0\",\"obj_type_cd\":\"GCQU\",\"id_value\":\"PT036516054=RRPS\",\"global_region_cd\":\"E\"}]}}]}}";
		String DSOSFeedData = "{\"govcorp\":{\"rduSecurities\":[{\"security\":{\"quote\":{\"pe\":null,\"quote_id\":\"0x000405003ea267fa\",\"currency_cd\":null,\"quote_permid\":\"34483976294\",\"asset_id\":\"0x0003f9016656c00b\",\"idn_contrib_cd\":null,\"price_src_cd\":\"EJV\",\"active_fl\":\"n\"},\"id_obj_xref_hist\":[{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"PT036516054=RRPS\",\"obj_oid\":\"0x000405003ea267fa\",\"id_type_cd\":\"RIC\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2008-05-27 00:00:00.0\",\"obj_type_cd\":\"GCQU\",\"id_value\":\"PT036516054=RRPS\",\"global_region_cd\":\"E\"}]}}]}}";
		JSONObject feedJsonObj = JsonConverterUtil.convertToSimpleJson(DSOSFeedData);
		JSONObject dbJsonObj = JsonConverterUtil.convertToSimpleJson(dbJson);
		Record feedRecord = new Record();
		feedRecord.getRecordRawData().setRawData(feedJsonObj);
		Record mergedRecord = feedVsDbMergeService.merge(feedRecord, dbJsonObj);
		assertEquals(true, mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.rduSecurities[?(@.security.quote.asset_id == '0x0003f9016656c00b' )]") instanceof JSONObject);
		assertEquals("n", mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.rduSecurities[?(@.security.quote.asset_id == '0x0003f9016656c00b' )].security.quote.active_fl"));
		assertEquals("RIC", mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.rduSecurities[?(@.security.quote.asset_id == '0x0003f9016656c00b')].security.id_obj_xref_hist[*].id_type_cd"));
	}
	

	@Test
	public void testMergeArrayQuoteObj_AddCompleteFeedArrayObjectInDbIfAbsentInDb() {
		String dbJson = "{\"govcorp\":{\"asset2\":{\"prtl_redemp_fl\":null,\"callable_notation\":null,\"repo_elig_id\":null,\"cusip_change_cd\":null,\"toggle_note_fl\":\"n\",\"instr_name\":\"8.5% FIX MTN DUE 2023\",\"asset_id\":\"0x00102caebb6f1553\",\"cur_cpn_class_cd\":\"FIX\",\"flip_opt_fl\":\"y\",\"straight_bond_fl\":\"n\",\"risk_country_cd\":null,\"sukuk_structure_fl\":null,\"prin_pay_redempt_cd\":null,\"fdic_insu_fl\":null,\"post_iss_icma_fl\":null,\"latest_iss_px\":\"100.0\",\"write_down_trigger_cd\":null,\"crd_compliance_fl\":null,\"dfrd_int_cnvrsn_dt\":null,\"trade_settle_curr_cd\":null,\"facility_amt\":null,\"aaoifi_compliant_fl\":null,\"hybrid_fl\":\"n\",\"next_par_call_dt\":null,\"odd_first_cpn_cd\":\"R\",\"liquidation_preference_cd\":\"SRU\",\"write_up_fl\":null,\"odd_first_cpn\":null,\"announcement_dt\":\"2018-08-23 02:39:00.0\",\"flip_opt_dt\":\"2021-08-29 00:00:00.0\",\"transition_bond_fl\":\"n\",\"green_bond_fl\":\"n\",\"sharia_opinion_fl\":null,\"gen_pay_rank_cd\":\"SEU\",\"conver_cd\":null,\"seniority_cd\":\"SR\",\"us_baby_bond_fl\":null,\"puttable_notation\":\"5np3(1x)\",\"orig_cusip_type_cd\":null,\"tax_credit_fl\":\"n\",\"cfi\":\"DBFXFR\",\"realtime_bond_type\":\"S\",\"debt_recourse_cd\":\"Y\",\"dtc_elig_fl\":null,\"us_section_13f_fl\":\"n\",\"trading_flat_fl\":null,\"esg_icma_fl\":null,\"odd_last_cpn_fl\":\"n\",\"esg_label_cd\":null,\"retail_sec_fl\":\"n\",\"eu_taxonomy_fl\":null,\"fisn\":\"OCEANWIDE/8.5 Dbt Fing Instr\",\"series\":null,\"tlac_elig_fl\":null,\"div_stopper_fl\":null,\"facility\":null,\"ftt_liable_fl\":\"n\",\"next_par_call_px\":null,\"reoffered_dt\":null,\"src_of_pmt_cd\":null,\"over_subscription\":null,\"bailin_fl\":null,\"cur_rate_cd\":\"N\",\"flip_opt_cd\":\"IO\",\"cav_maturity_amt\":null,\"esg_compliance_cd\":null,\"ftt_report_fl\":\"n\",\"org_of_risk_id\":null,\"latest_iss_dt\":\"2018-08-27 00:00:00.0\",\"cur_amt_factor\":\"1.0\",\"security_cd\":null,\"odd_first_cpn_fl\":\"n\",\"div_pusher_fl\":null,\"ucits_compliance_fl\":null,\"prerefunded_fl\":null,\"structured_fl\":\"n\",\"term_to_maturity_yrs\":\"5Y\",\"reoffered_fl\":null,\"isa_eligible_fl\":\"n\",\"repo_elig_fl\":\"n\",\"rrps_ric_permid\":\"46667052112\",\"org_of_risk_audit_cd\":null,\"tier_capital_cd\":null,\"cic_cd\":\"CN29\",\"survivor_opt_fl\":\"n\",\"odd_last_cpn_cd\":\"R\",\"local_iss_dt\":null,\"write_down_trigg_ratio\":null,\"cdc_asset_class_cd\":\"MTN\",\"letter_of_credit_fl\":\"n\",\"structured_cd\":null,\"estimated_free_cnv_fl\":null,\"borrower_id\":null,\"cusip_change_dt\":null,\"finra_sub_prdct_type_cd\":null,\"solvability_ratio\":null,\"cleanup_call_fl\":\"n\",\"cntry_of_risk_cd\":null,\"cur_int_defer_fl\":\"n\",\"risk_classifications_cd\":null,\"trade_asset_type_cd\":null,\"make_whole_call_fl\":\"n\",\"write_down_fl\":null,\"issue_id\":null,\"esg_bond_fl\":\"n\",\"calc_disable_rsn\":null,\"qdi_elig_fl\":\"n\",\"write_down_type_cd\":null,\"super_sinker_fl\":null,\"asset_eff_dt\":\"2018-08-27 00:00:00.0\",\"realtime_building_block\":\"CORP\",\"pgm_iss_fl\":\"y\",\"addl_credit_fl\":null,\"mrel_elig_fl\":null,\"drd_elig_fl\":\"n\",\"cap_cont_fl\":\"n\"},\"rduSecurities\":[{\"security\":{\"mic_opol\":{\"sedol_eff_dt\":\"2021-07-19 00:00:00.0\",\"opol_fl\":\"y\",\"asset_id\":\"0x00102caebb6f1553\",\"sedol\":\"BN94HW4\",\"sedol_end_dt\":null,\"mic_cd\":\"XCFE\"}}}],\"asset\":{\"current_cpn\":\"8.5\",\"wpk_nm\":null,\"funged_fl\":\"n\",\"bankwatch_rating_dt\":null,\"latest_rating_src_cd\":null,\"asset_id\":\"0x00102caebb6f1553\",\"asset_status_cd\":\"DEF\",\"ibs_control_nm\":null,\"project_name\":null,\"emerging_market_fl\":\"n\",\"last_reset_dt\":null,\"mandatory_tender_dt\":null,\"mdy_rating_cd\":null,\"unit_cd\":null,\"next_sink_dt\":null,\"strip_total\":null,\"capitalization_fl\":\"n\",\"next_put_dt\":null,\"dom_settle_val\":\"1\",\"pay_freq_cd\":\"1\",\"mdy_rating_dt\":null,\"cur_prin_leg_nm\":\"1\",\"debt_svc_cd\":null,\"put_terms_fl\":\"y\",\"tot_prog_amt\":null,\"mdy_st_rtng_dt\":null,\"dcs_type_cd\":\"B\",\"next_pay_dt\":null,\"asset_setup_dt\":\"2018-08-23 02:39:00.0\",\"cur_amt_outsd\":\"700000.0\",\"trace_cd\":\"N\",\"next_reset_dt\":null,\"strippable_fl\":\"n\",\"day_count_cd\":\"5\",\"ibca_rating_dt\":null,\"rtfi_us_elig_cd\":\"SEA\",\"tap_end_dt\":null,\"status_of_document\":\"2\",\"exdiv_val\":null,\"asset_duplicate_cd\":null,\"valoren_nm\":null,\"life_cap\":null,\"pay_in_part_fl\":\"n\",\"oid_fl\":null,\"prospectus_dt\":\"2018-08-27 00:00:00.0\",\"mdy_watch_cd\":null,\"credit_sensitive_fl\":\"n\",\"dp_rating_dt\":null,\"lead_undwrt_cd\":\"\",\"sp_rating_cd\":null,\"clawback_type_cd\":null,\"min_denom\":\"100.0\",\"call_terms_fl\":\"n\",\"call_type_cd\":null,\"mdy_watch_dt\":null,\"sp_st_rtng_cd\":null,\"nsin_nm\":\"CND10001ZXY6\",\"float_mult\":null,\"min_credit_rating_cd\":\"AA-\",\"native_yld_type_cd\":\"CB\",\"asset_ticker\":\"OWREP\",\"fitch_rating_cd\":null,\"asset_templt_cd\":\"CC\",\"bankwatch_rating_cd\":null,\"annuity_fl\":\"n\",\"cpn_type_cd\":\"FXPV\",\"refund_dt\":null,\"status_eff_dt\":\"2021-08-29 00:00:00.0\",\"convertible_fl\":\"n\",\"tap_issue_fl\":\"n\",\"asset_permid\":\"192809957069\",\"latest_rating_eff_dt\":null,\"cur_amt_outsd_chg_cd\":\"ISS\",\"prosp_on_file_fl\":\"y\",\"sovr_class_cd\":null,\"sp_watch_dt\":null,\"dom_settle_cal_cd\":\"BDY\",\"last_cpn_dt\":\"2022-08-29 00:00:00.0\",\"redemption_val\":\"100.0\",\"orig_iss_dt\":\"2018-08-27 00:00:00.0\",\"record_dt_val\":null,\"stick_suppl_fl\":\"n\",\"exdiv_cal_cd\":null,\"multistep_flt_fl\":\"n\",\"dp_rating_cd\":null,\"float_offset\":null,\"cur_prin_curr_cd\":\"CNY\",\"secondary_insu_fl\":null,\"issuer_id\":\"0x000405016f81ce20\",\"record_dt_cd\":null,\"common_code_nm\":null,\"next_sink_amt\":null,\"orig_amt_iss\":\"700000.0\",\"series\":null,\"fitch_ibca_rating_cd\":null,\"tax_call_fl\":\"n\",\"asset_cf_corr_dt\":null,\"descr_detail\":null,\"er_score\":\"4\",\"prosp_suppl_dt\":null,\"rrps_ric\":\"CN101800969=RRPS\",\"domin_rating_cd\":null,\"exch_listed_fl\":\"y\",\"ibca_rating_cd\":null,\"next_call_px\":null,\"primary_quote_id\":\"00102C6F478A158B\",\"fitch_rating_dt\":null,\"cusip\":null,\"pik_inkind_pmt_dt\":null,\"tax_status_cd\":null,\"equity_clawback_fl\":\"n\",\"amt_iss_tot\":\"700000.0\",\"next_call_dt\":null,\"physical_form_cd\":\"BKE\",\"isin_nm\":\"CND10001ZXY6\",\"mtn_shelf_id\":\"0x00102c40d75f0df9\",\"full_bridge_symbol\":\"cn*;OWREP-8.5-0823\",\"pik_fl\":\"n\",\"ds_subtype_cd\":\"CFIN\",\"life_floor\":null,\"domin_rating_dt\":null,\"fitch_ibca_rating_dt\":null,\"pay_cal_cd\":\"CDM\",\"first_cpn_dt\":\"2019-08-29 00:00:00.0\",\"maturity_dt\":\"2023-08-29 00:00:00.0\",\"dual_cur_fl\":\"n\",\"first_reset_dt\":null,\"cur_int_leg_nm\":\"1\",\"next_put_px\":null,\"distribution_src_cd\":\"RTRI\",\"perpetual_fl\":\"n\",\"cpn_class_cd\":\"FIX\",\"latest_rating_cd\":null,\"sp_st_rtng_dt\":null,\"bridge_symbol\":\"OWREP-8.5-0823\",\"dbs_pid\":\"110000B0313QH\",\"int_idx_lnk_fl\":null,\"float_index\":null,\"debt_type_cd\":\"SRNT\",\"prosp_suppl_nm\":null,\"sec_class_cd\":null,\"descr\":\"OWREP  8.500 08/29/23 MTN DFTd\",\"sp_watch_cd\":null,\"cntry_of_iss_cd\":\"CN\",\"sp_rating_dt\":null,\"eusd_tax_fl\":\"y\",\"currency_cd\":\"CNY\",\"withholding_tax\":null,\"orig_dated_dt\":\"2018-08-29 00:00:00.0\",\"exec_quote_fl\":\"n\",\"warrants_fl\":\"n\",\"sp_debt_class_cd\":null,\"private_place_fl\":\"n\",\"nsin_agn_cd\":\"ISN\",\"mtn_fl\":\"y\",\"denom_type_cd\":\"BKE\",\"euroclear_nm\":null,\"poison_put_fl\":\"n\",\"isin_src_cd\":null,\"trace_grade_cd\":null,\"asset_subtype_cd\":\"DMTC\",\"amt_iss_public\":null,\"asset_type_cd\":\"CORP\",\"defeased_fl\":\"n\",\"settle_bus_ctr_cd\":\"CN\",\"float_formula\":null,\"asset_last_chg_dt\":\"2023-03-06 17:49:00.0\",\"standard_yld_type_cd\":\"IS\",\"denom_incr\":\"100.0\",\"asset_info_src_cd\":\"RTR\",\"mdy_st_rtng_cd\":null,\"spec_put_fl\":\"n\",\"prin_idx_lnk_fl\":\"n\",\"guarantee_fl\":\"n\",\"pay_cal_val\":\"29\",\"fund_terms_fl\":\"n\",\"mdy_debt_class_cd\":null,\"pik_csh_pmt_dt\":null,\"bank_qualified_fl\":null,\"exp_maturity_dt\":null,\"secured_fl\":\"n\",\"for_settle_val\":null,\"next_mand_tender_dt\":null,\"fig_rule_cd\":\"C\",\"rtr_ticker\":\"OWREP\",\"rcs_class_cd\":\"BOND\",\"extend_terms_fl\":\"n\",\"preferred_ric\":\"CN101800969=\",\"ds_type_cd\":\"CORP\",\"inflation_protect_fl\":\"n\",\"cur_amt_out_dt\":\"2018-08-27 00:00:00.0\"}}}";
		String DSOSFeedData = "{\"govcorp\":{\"rduSecurities\":[{\"security\":{\"quote\":{\"pe\":null,\"quote_id\":\"0x000405003ea267fa\",\"currency_cd\":null,\"quote_permid\":\"34483976294\",\"asset_id\":\"0x00102caebb6f1553\",\"idn_contrib_cd\":null,\"price_src_cd\":\"EJV\",\"active_fl\":\"n\"},\"id_obj_xref_hist\":[{\"primary_fl\":null,\"end_dt\":null,\"id_upper\":\"PT036516054=RRPS\",\"obj_oid\":\"0x000405003ea267fa\",\"id_type_cd\":\"RIC\",\"current_fl\":\"y\",\"id_scope_id\":null,\"eff_dt\":\"2008-05-27 00:00:00.0\",\"obj_type_cd\":\"GCQU\",\"id_value\":\"PT036516054=RRPS\",\"global_region_cd\":\"E\"}]}}]}}";
		JSONObject feedJsonObj = JsonConverterUtil.convertToSimpleJson(DSOSFeedData);
		JSONObject dbJsonObj = JsonConverterUtil.convertToSimpleJson(dbJson);
		Record feedRecord = new Record();
		feedRecord.getRecordRawData().setRawData(feedJsonObj);
		Record mergedRecord = feedVsDbMergeService.merge(feedRecord, dbJsonObj);
		assertNull(dbJsonObj.get(ID_OBJ_XREF_HIST_TABLE_NAME));
		assertEquals("0x000405003ea267fa", mergedRecord.getRecordRawData().getRawDataAttribute("$.govcorp.rduSecurities[?(@.security.quote.asset_id == '0x00102caebb6f1553')].security.id_obj_xref_hist[*].obj_oid"));
	}
	
}
